{% extends 'base2.html' %}
{% load static %}

{% block header %}

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>Resume - Start Bootstrap Theme</title>
    <link rel="icon" type="image/x-icon" href="{% static 'static-u/assets/img/favicon.ico' %}" />
    <!-- Font Awesome icons (free version)-->
    <script src="https://use.fontawesome.com/releases/v5.15.4/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:500,700" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,800,800i" rel="stylesheet" type="text/css" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="{% static 'static-u/css/styles.css' %}" rel="stylesheet" />

    <script type="text/javascript">
      function rdm(){
        var listnum = document.querySelectorAll( "h1" );
        var playlist = [];
        for(var x = 1; x < listnum.length; x++){
            var y = String(x)
            var pla =document.getElementById(y).title;
            playlist.push(pla);
        }
        var audio = document.createElement('audio');
        document.body.appendChild(audio);
        audio.style.width = '100%';
        // audio.style.height = 'auto muted';
        audio.classList.add('sticky-bottom');
        audio.controls = true;
        audio.volume = 0;

        audio.src = playlist[0];
        audio.play();
        var index = 0;

        audio.addEventListener('ended', function(){
          index = Math.floor(Math.random() * playlist.length);
        //   alert(index)
          audio.src = playlist[index];
          audio.play();
        });
      }

      function ctn(){
        var listnum = document.querySelectorAll( "h1" );
        var playlist = [];
        for(var x = 1; x < listnum.length; x++){
            var y = String(x)
            var pla =document.getElementById(y).title;
            playlist.push(pla);
        }

        var audio = document.createElement('audio');
        document.body.appendChild(audio);
        audio.style.width = '100%';
        // audio.style.height = 'auto muted';
        audio.classList.add('sticky-bottom');
        audio.controls = true;
        audio.volume = 0.01;
        audio.src = playlist[0];
        audio.play();

        var index = 0;
        audio.addEventListener('ended', function(){
            index++;
            if (index < playlist.length) {
                audio.src = playlist[index];
                audio.play();
            }
            else {
                audio.src = playlist[0];
                audio.play();
                index = 0;
            }
        });
    }
      

    </script>
</head>
{% endblock %}

{% block contents %}
<div class="container">
    <div class="my-div-style w-100">
        <div class="row">
            <div class="col-3">
                <strong>タイトル</strong>
                <hr>
                <input id="button1" type="button" value="ボタンを押す" onclick="rdm()">
                <input id="button2" type="button" value="ボタンを押す" onclick="ctn()">
            </div>
            
            {% for group in grouped_list %}
                    <div class="post-preview">
                        <h2 class="post-title">
                            {{ group.group }}
                        </h2>
                        <h1></h1><!--必要-->
                        <div id="{{ forloop.counter }}" title="{{ group.music.attach1.url }}"></div>
                    </div>
                    <hr>
                    {% empty %}
                    <p>音楽がありません</p>
            {% endfor %}
            <audio id='audio'></audio>
        </div>

        <hr>

        
    </div>
</div>
{% endblock %}